"use strict"
var fs = require('fs');
var path = require('path');
var program = require('commander');
var packageInfo =require("../package.json");

program
    .command('deploy [args]')
    .action(function(args){
        console.log(args);
    });
program.version(packageInfo.version)
    .option('-n, --new', 'Create a new file')
    .option('--file [filename]', 'Filename to convert')
    .parse(process.argv);



function copyFile(from, to){
    return fs.createReadStream(from).pipe(fs.createWriteStream(to));
}

function convert(){
    if(program.new){
        var newfile = path.join(path.dirname(fs.realpathSync(__filename)), '../lib/examples/file.txt');
        copyFile(newfile, path.join(process.cwd(), "file.txt"));
    }else if(program.file){
        // Read the first additional argument passed to the program
        var myfile = program.file;

        if(fs.existsSync(myfile)) {
            var content = fs.readFileSync(myfile, 'utf8');
            fs.writeFileSync(myfile, content.toUpperCase());
            console.log("Done");
        } else {
            console.log("File does not exist - " + myfile);
        }
    }else{
        console.log("ERROR: Pass on a file name/path");
    }

}

exports.convert = convert;